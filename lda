 // Configure GroupWriteSupport with schema
        GroupWriteSupport writeSupport = new GroupWriteSupport();
        writeSupport.setSchema(schema, new Configuration());

        // Create ParquetWriter instance
        ParquetWriter<Group> writer = new ParquetWriter<>(
                new Path("inmemory"), // Output path (not used for in-memory write)
                writeSupport, // GroupWriteSupport
                ParquetWriter.DEFAULT_COMPRESSION_CODEC_NAME,
                ParquetWriter.DEFAULT_BLOCK_SIZE,
                ParquetWriter.DEFAULT_PAGE_SIZE,
                ParquetWriter.MAX_PADDING_SIZE_DEFAULT,
                false, // Enable dictionary encoding
                false // Enable schema validation
        );
